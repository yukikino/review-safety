# 運用マニュアル

**対象**: 非エンジニア（コンテンツ担当者）
**最終更新**: 2025-10-27

このドキュメントは、技術的な知識がない方でもサイトを運用できるよう、手順を明確に記載しています。

---

## 目次

1. [初期セットアップ](#初期セットアップ)
   - 必要なアクセス権限
2. [日常的な作業](#日常的な作業)
   - 比較表の更新
   - 記事の追加
3. [週次メンテナンス](#週次メンテナンス)
4. [トラブルシューティング](#トラブルシューティング)
5. [チェックリスト](#チェックリスト)

---

## 初期セットアップ

### 必要なアクセス権限

運用を開始する前に、以下のアクセス権限を管理者から付与してもらってください。

#### 1. Google Sheets

**権限レベル**: 編集者
**対象シート**: 商品管理シート（`products` シート）

**確認方法**:

1. [商品管理シート](https://docs.google.com/spreadsheets/d/...) を開く
2. セルを編集できればOK
3. 編集できない場合は管理者に連絡

**注意**:

- ⚠️ Apps Script の編集権限は**不要**（管理者のみ）
- ✅ シートの閲覧・編集のみできればOK

#### 2. GitHub

**権限レベル**: Write
**対象リポジトリ**: `your-org/your-repo`

**必要な操作**:

- ブランチ作成
- ファイル編集
- Pull Request 作成

**確認方法**:

1. [GitHubリポジトリ](https://github.com/your-org/your-repo) を開く
2. 「Add file」ボタンが表示されればOK
3. 表示されない場合は管理者に連絡

#### 3. Vercel

**権限レベル**: Viewer（閲覧のみ）
**対象プロジェクト**: `your-project`

**必要な操作**:

- デプロイ状況の確認
- プレビューURLの閲覧
- Analytics の閲覧

**確認方法**:

1. [Vercel Dashboard](https://vercel.com/dashboard) を開く
2. プロジェクトが表示されればOK
3. 表示されない場合は管理者に招待してもらう

#### 4. Slack

**必要なチャンネル**:

- `#affiliate-reports`: 週次レポート通知
- `#affiliate-alerts`: エラー通知（GitHub Actions失敗など）
- `#affiliate-team`: チームディスカッション

**確認方法**:

1. Slack を開く
2. 左サイドバーに上記チャンネルが表示されればOK
3. 表示されない場合は管理者にチャンネル招待してもらう

#### 5. ASP管理画面（アフィリエイトサービス）

**必要なASP**:

- A8.net
- Afb（アフィb）
- その他（プロジェクトによる）

**必要な操作**:

- EPC データの確認
- アフィリエイトリンクの発行・確認

**確認方法**:
各ASPの管理画面にログインできればOK

---

### アクセス権限のトラブルシューティング

**Q: Googleシートが編集できない**
A: 管理者に連絡して「編集者」権限を付与してもらってください。

**Q: GitHubでファイルを作成できない**
A: リポジトリの「Settings」→「Collaborators」で「Write」権限が付与されているか確認してください。

**Q: Vercel Dashboardが見れない**
A: Vercelのチーム招待メールが届いていないか確認してください（迷惑メールフォルダも確認）。

**Q: Slack通知が来ない**
A: チャンネルに参加しているか確認してください。`/join #affiliate-reports` で参加できます。

---

## 日常的な作業

### A. 比較表の更新（所要時間: 5分）

商品の価格や返金条件が変更された時に実施します。

#### 手順

1. **Googleシートを開く**
   - ブックマークから「商品管理シート」を開く
   - 「products」タブを選択

2. **データを編集**
   - 該当商品の行を探す（商品名で検索可能）
   - 変更する列を編集（例: `price_monthly`）
   - 必ず以下も更新：
     - `last_updated`（今日の日付）
     - `source_url`（公式ページのURL）

3. **保存を確認**
   - 自動保存されます（左上に「すべての変更を保存しました」と表示）
   - ⚠️ 保存されないと自動デプロイが始まりません

4. **デプロイを確認**（5分後）
   - [Vercel Dashboard](https://vercel.com/dashboard) を開く
   - 「Deployments」タブで最新のデプロイを確認
   - ステータスが「Ready」になれば完了

5. **プレビューで確認**
   - デプロイの「Visit」ボタンをクリック
   - 比較ページ（`/compare`）を開く
   - 変更した価格が反映されているか確認

6. **本番反映**
   - 問題なければ、自動的に本番サイトにも反映されます
   - 本番URLでも確認

#### 注意事項

- ❌ `id` 列は絶対に変更しない（記事とのリンクが壊れます）
- ✅ 価格は必ず公式サイトで確認してから入力
- ✅ `last_updated` を更新し忘れないこと（法的リスク）

#### 編集可能な列

| 列名            | 説明                 | 例                |
| --------------- | -------------------- | ----------------- |
| `name`          | 商品名               | `Surfshark VPN`   |
| `price_monthly` | 月額料金（USD）      | `12.95`           |
| `price_annual`  | 年額料金（USD）      | `47.88`           |
| `refund_days`   | 返金保証日数         | `30`              |
| `japan_ui`      | 日本語UIあり         | `TRUE` or `FALSE` |
| `japan_payment` | 日本の決済対応       | `TRUE` or `FALSE` |
| `japan_support` | 日本語サポート       | `TRUE` or `FALSE` |
| `japan_docs`    | 日本語ドキュメント   | `TRUE` or `FALSE` |
| `affiliate_url` | アフィリエイトリンク | `https://...`     |
| `last_updated`  | 最終確認日           | `2025-10-27`      |
| `source_url`    | 公式ページURL        | `https://...`     |

#### よくある質問

**Q: 編集後、どれくらいで反映される？**
A: 通常5-10分です。Vercel Dashboardで進捗を確認できます。

**Q: 間違えて編集してしまった！**
A: Googleシートの「編集履歴」から復元できます（上部メニュー「ファイル」→「変更履歴」→「変更履歴を表示」）

**Q: 新しい商品を追加したい**
A: エンジニアに依頼してください。商品追加は記事作成とセットで行います。

---

### B. 記事の追加（所要時間: 30分 + 執筆時間）

新しい商品レビュー記事やハウツー記事を追加します。

#### 前提知識

- GitHub アカウントが必要
- ブランチ、PR（プルリクエスト）の概念を理解（後述）

#### 手順

##### 1. テンプレートをコピー

1. [GitHub リポジトリ](https://github.com/your-org/your-repo) を開く
2. `templates/` フォルダに移動
3. 記事タイプに応じてテンプレートを選択：
   - `review.md`（商品レビュー）
   - `howto.md`（使い方ガイド）
4. ファイルの内容をコピー

##### 2. 新しい記事ファイルを作成

1. `content/review/` または `content/howto/` に移動
2. 「Add file」→「Create new file」をクリック
3. ファイル名を入力（例: `surfshark-review.md`）
   - ⚠️ 英小文字とハイフンのみ使用
   - ⚠️ `.md` で終わること

##### 3. Frontmatter を編集

ファイルの先頭部分（`---` で囲まれた部分）を編集：

```yaml
---
title: '【2025年最新】Surfsharkの評判・レビュー｜実際に使ってみた'
description: 'SurfsharkVPNの実際の使用感、料金、返金方法を徹底解説。日本からの利用で気をつけるポイントも紹介します。'
publishedAt: '2025-10-27'
updatedAt: '2025-10-27'
category: 'review'
productId: 'surfshark-vpn' # ← Googleシートのid列と一致させる
keywords: ['Surfshark', 'VPN', 'レビュー', '評判']
---
```

**重要**:

- `title`: 30-60文字（SEOチェックで自動判定）
- `description`: 120-160文字
- `productId`: Googleシートの `id` 列と完全一致
- `publishedAt`: 今日の日付
- `updatedAt`: 今日の日付

##### 4. 本文を執筆

テンプレートの `` 部分を埋めていきます。

**必須セクション**（これがないとSEOチェックで×）:

- ✅ 結論ボックス
- ✅ 詳細レビュー
- ✅ 返金・解約方法
- ✅ FAQ（最低3つ）

**執筆ガイドライン**:

- 見出しは H2（`##`）から開始
- 箇条書きを活用
- 画像は `images/` フォルダに配置（後でアップロード）
- 内部リンクを最低3つ入れる（他の記事へのリンク）

##### 5. ブランチを作成してコミット

1. ページ下部の「Commit changes」セクション
2. 「Create a new branch for this commit」を選択
3. ブランチ名を入力（例: `article/surfshark-review`）
4. コミットメッセージ: `feat: add Surfshark review article`
5. 「Propose changes」をクリック

##### 6. プルリクエスト（PR）を作成

1. 自動的にPR作成画面に遷移
2. タイトル: `新規記事: Surfsharkレビュー`
3. 本文は自動で表示されるチェックリストを埋める：

   ```markdown
   ## チェックリスト

   - [x] タイトルが30-60文字
   - [x] FAQセクションがある
   - [x] 返金・解約方法を記載
   - [x] 内部リンクが3つ以上
   ```

4. 「Create pull request」をクリック

##### 7. CIチェックを確認

1. PR ページで自動チェックが開始されます（2-3分）
2. ✅ 全てのチェックが通ればOK
3. ❌ 失敗した場合は詳細を確認：
   - 「Details」をクリック
   - エラーメッセージを読む（例: 「タイトルが61文字で長すぎます」）

##### 8. 修正が必要な場合

1. GitHub上で該当ファイルを開く
2. 「Edit file」で修正
3. コミット（同じブランチに追加される）
4. 自動的に再チェックが走る

##### 9. マージ

1. 全てのチェックが通ったら「Merge pull request」をクリック
2. 「Confirm merge」
3. 自動的に Vercel デプロイが開始
4. 5分後、本番サイトで記事が公開される

#### よくある質問

**Q: Markdownの書き方がわからない**
A: [Markdownガイド](https://www.markdownguide.org/basic-syntax/) を参照してください。

**Q: 画像をアップロードしたい**
A: GitHub上で `public/images/` フォルダに画像をアップロード → 記事内で `![説明文](/images/filename.jpg)` で参照

**Q: SEOチェックで「FAQ構造化データがありません」と出た**
A: FAQセクションの書き方を確認：

```markdown
## FAQ

### Q: Surfsharkは日本語対応していますか？

A: はい、管理画面は日本語で利用できます。

### Q: 返金は簡単にできますか？

A: チャットで依頼すれば即日対応してもらえます。
```

**Q: 内部リンクってどう書くの？**
A: 他の記事へのリンク：

```markdown
[VPN比較ランキング](/compare)
[NordVPNのレビュー](/review/nordvpn)
```

---

## 週次メンテナンス

### 毎週月曜 10:00 に実施

#### 1. EPC × 日本対応スコアの棚卸し（15分）

**目的**: 収益性の高い商品を優先的に紹介

1. ASP管理画面にログイン（A8.net, Afb等）
2. 先週のEPC（Earnings Per Click）を確認
3. Googleシートの「EPC」列を更新
4. 日本対応スコアと掛け合わせて「推奨度」を計算（自動）
5. 比較表の並び順が自動的に更新される

#### 2. リンク切れチェック（5分）

**方法**:

1. [Vercel Dashboard](https://vercel.com/dashboard) → 「Analytics」
2. 「Link Checker」タブで404エラーを確認
3. 該当する記事を修正（アフィリエイトリンクが無効になっていないか）

#### 3. 週次レポートの確認（10分）

**自動で Slack に通知される内容**:

- 先週のPV・UU
- 上位10記事のCVR
- 新規追加記事数
- Lighthouse スコアの変化

**通知が来ない場合の確認手順**:

1. Slack の `#affiliate-reports` チャンネルを確認
2. 通知がない場合、[GitHub Actions](https://github.com/your-org/your-repo/actions/workflows/weekly.yml) を開く
3. 「Run workflow」ボタンで手動実行
4. それでも失敗する場合はエンジニアに連絡

**手動でレポートを確認する方法**:

- Google Analytics 4 ダッシュボード: [GA4リンク]
- Vercel Analytics: [Vercel Dashboard](https://vercel.com/dashboard) → 「Analytics」

**アクション**:

- CVRが低い記事の原因を分析
- CTA（Call To Action）の文言変更を検討
- 画像の追加やFAQの拡充を検討

---

## トラブルシューティング

### 🚨 Googleシートを編集したのに反映されない

**原因と対処**:

1. **自動保存されていない**
   - 左上に「すべての変更を保存しました」が出ているか確認
   - 出ていなければ、セルをもう一度クリックして Enter を押す

2. **GitHub Actions が失敗している**
   - [GitHub Actions](https://github.com/your-org/your-repo/actions) を開く
   - 最新のワークフローが「❌」になっていないか確認
   - エンジニアに連絡

3. **Vercel デプロイが失敗している**
   - [Vercel Dashboard](https://vercel.com/dashboard) を開く
   - デプロイが「Error」になっていないか確認
   - エンジニアに連絡

### 🚨 記事のSEOチェックが通らない

**よくあるエラーと対処**:

| エラー                    | 原因                | 対処                                                               |
| ------------------------- | ------------------- | ------------------------------------------------------------------ |
| Title too long            | タイトルが60文字超  | タイトルを短くする                                                 |
| Missing FAQ section       | FAQがない           | `## FAQ` セクションを追加                                          |
| Not enough internal links | 内部リンクが3つ未満 | 他の記事へのリンクを追加                                           |
| H1 not found              | H1見出しがない      | Frontmatterの `title` が自動的にH1になる（見出しは `##` から開始） |

### 🚨 画像が表示されない

**チェックポイント**:

1. 画像が `public/images/` にアップロードされているか
2. 記事内のパスが `/images/filename.jpg` になっているか（先頭の `/` を忘れずに）
3. ファイル名に日本語やスペースが含まれていないか

### 🚨 アフィリエイトリンクが機能しない

**チェックポイント**:

1. Googleシートの `affiliate_url` が正しいか
2. リンクの有効期限が切れていないか（ASP管理画面で確認）
3. リンクをクリックして実際に遷移するか確認

---

## チェックリスト

### 比較表更新時

- [ ] 公式サイトで最新情報を確認済み
- [ ] `last_updated` を今日の日付に更新
- [ ] `source_url` を記載
- [ ] Googleシートが保存されている
- [ ] Vercel でデプロイ完了を確認
- [ ] プレビューで変更を確認
- [ ] 本番サイトで最終確認

### 記事追加時

- [ ] テンプレートを使用
- [ ] Frontmatter を正しく記入
  - [ ] タイトルが30-60文字
  - [ ] description が120-160文字
  - [ ] productId がシートのidと一致
- [ ] 必須セクションを記載
  - [ ] 結論ボックス
  - [ ] 詳細レビュー
  - [ ] 返金・解約方法
  - [ ] FAQ（3つ以上）
- [ ] 内部リンクが3つ以上
- [ ] 画像にalt属性（説明文）を記載
- [ ] ブランチを作成してPR
- [ ] CIチェックが全て通過
- [ ] マージ後、本番で確認

### 週次メンテナンス

- [ ] EPC データを更新
- [ ] リンク切れをチェック
- [ ] 週次レポートを確認
- [ ] CVRが低い記事の改善案を考える
- [ ] 来週の記事計画を立てる

---

## 連絡先

**トラブル発生時**:

- エンジニア: `[エンジニアのメール/Slack]`
- 技術サポート: `[サポートチャンネル]`

**定期ミーティング**:

- 毎週金曜 15:00 - 進捗共有
- 毎月末 - 月次レビュー

---

## 参考資料

- [ARCHITECTURE.md](./ARCHITECTURE.md) - 全体設計
- [IMPLEMENTATION_PLAN.md](./IMPLEMENTATION_PLAN.md) - 実装計画
- [Markdownガイド](https://www.markdownguide.org/basic-syntax/)
- [Next.js 公式ドキュメント](https://nextjs.org/docs)
